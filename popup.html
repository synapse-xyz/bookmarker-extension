<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Notion URL Saver</title>
  <link rel="stylesheet" href="popup.css">
</head>

<body>

  <!-- Vista de Onboarding -->
  <div id="onboarding-view" class="view hidden">
    <div class="center-content">
      <div class="container-small">
        <form id="onboarding-form" class="card">
          <div class="form-header">
            <h1 class="title">Configuración Inicial</h1>
            <p class="subtitle">Conecta tu extensión con Notion</p>
          </div>

          <div class="form-group">
            <label class="label">Notion API Key</label>
            <div class="control">
              <input class="input" type="password" id="api-key" placeholder="secret_xxxxxxxxxxxxx" required>
            </div>
            <p class="help">Obtén tu API key en <a href="https://www.notion.so/my-integrations" target="_blank">Notion
                Integrations</a></p>
          </div>

          <div class="form-group">
            <label class="label">Database ID</label>
            <div class="control">
              <input class="input" type="text" id="database-id" placeholder="xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"
                required>
            </div>
            <p class="help">El ID de tu base de datos (UUID)</p>
          </div>

          <div id="error-message" class="notification error hidden"></div>

          <div class="form-actions">
            <button type="submit" id="save-config-btn" class="button primary full-width">
              <span id="save-config-btn-text">Guardar Configuración</span>
              <svg xmlns="http://www.w3.org/2000/svg" id="save-config-btn-loader" width="24" height="24" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                class="icon icon-tabler icons-tabler-outline icon-tabler-loader loader hidden">
                <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                <path d="M12 6l0 -3" />
                <path d="M16.25 7.75l2.15 -2.15" />
                <path d="M18 12l3 0" />
                <path d="M16.25 16.25l2.15 2.15" />
                <path d="M12 18l0 3" />
                <path d="M7.75 16.25l-2.15 2.15" />
                <path d="M6 12l-3 0" />
                <path d="M7.75 7.75l-2.15 -2.15" />
              </svg>
            </button>
          </div>
        </form>

      </div>
    </div>
  </div>

  <!-- Vista Principal -->
  <div id="main-view" class="view hidden">

    <div class="main-layout">

      <!-- Sidebar -->
      <div class="sidebar">
        <div class="sidebar-header">
          <p class="menu-label">Perfiles</p>
        </div>

        <div class="profile-list-container">
          <ul class="menu-list" id="profile-list">
            <!-- Generado dinámicamente -->
          </ul>
        </div>

        <div class="sidebar-footer">
          <button id="add-profile-btn" class="button small full-width mb-2" title="Añadir perfil">
            <span class="icon">➕</span> Añadir
          </button>
          <button id="config-btn" class="button small full-width secondary" title="Configuración">
            <span class="icon">⚙️</span> Ajustes
          </button>
        </div>
      </div>

      <!-- Main Content -->
      <div class="content">
        <!-- Refresh Button -->
        <div class="refresh-button-container">
          <button id="refresh-btn" class="button icon-only rounded shadow" title="Actualizar metadatos">
            ↻
          </button>
        </div>

        <h1 class="content-title">Guardar URL</h1>

        <div id="status-message" class="notification hidden"></div>

        <div class="url-preview-box">
          <p class="url-text" id="current-url">Cargando URL...</p>
        </div>

        <div class="form-group">
          <label class="label">Categoría (opcional)</label>
          <div class="control">
            <div class="select-wrapper">
              <select id="label-select" class="select full-width">
                <option value="">Sin categoría</option>
              </select>
            </div>
          </div>
        </div>

        <button id="save-url-btn" class="button primary full-width mt-4">
          <span id="save-url-btn-text">Guardar en Notion</span>
          <svg xmlns="http://www.w3.org/2000/svg" id="save-url-btn-loader" width="24" height="24" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                class="icon icon-tabler icons-tabler-outline icon-tabler-loader loader hidden">
                <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                <path d="M12 6l0 -3" />
                <path d="M16.25 7.75l2.15 -2.15" />
                <path d="M18 12l3 0" />
                <path d="M16.25 16.25l2.15 2.15" />
                <path d="M12 18l0 3" />
                <path d="M7.75 16.25l-2.15 2.15" />
                <path d="M6 12l-3 0" />
                <path d="M7.75 7.75l-2.15 -2.15" />
              </svg>
        </button>
      </div>
    </div>
  </div>

  <!-- Modal: Añadir Nuevo Perfil -->
  <div id="add-profile-modal" class="modal hidden">
    <div class="modal-overlay" id="modal-overlay-add"></div>
    <div class="modal-card">
      <header class="modal-header">
        <p class="modal-title">Nuevo Perfil</p>
        <button class="close-modal" id="close-add-modal" aria-label="close">&times;</button>
      </header>
      <section class="modal-body">
        <form id="add-profile-form">
          <div class="form-group">
            <label class="label">API Key</label>
            <div class="control">
              <input class="input" type="password" id="modal-api-key" placeholder="secret_..." required>
            </div>
          </div>
          <div class="form-group">
            <label class="label">Database ID</label>
            <div class="control">
              <input class="input" type="text" id="modal-db-id" placeholder="uuid" required>
            </div>
          </div>
          <div id="modal-error" class="notification error hidden"></div>
        </form>
      </section>
      <footer class="modal-footer">
        <button class="button secondary" id="cancel-add-modal">Cancelar</button>
        <button class="button primary" type="submit" form="add-profile-form">Guardar</button>
      </footer>
    </div>
  </div>

  <!-- Modal: Configuración -->
  <div id="settings-modal" class="modal hidden">
    <div class="modal-overlay" id="modal-overlay-settings"></div>
    <div class="modal-card">
      <header class="modal-header">
        <p class="modal-title">Configuración</p>
        <button class="close-modal" id="close-settings-modal" aria-label="close">&times;</button>
      </header>
      <section class="modal-body">
        <form id="settings-form">
          <div class="form-group">
            <label class="label">API Key</label>
            <div class="control">
              <input class="input" type="password" id="settings-api-key" required>
            </div>
          </div>
          <div class="form-group">
            <label class="label">Database ID</label>
            <div class="control">
              <input class="input" type="text" id="settings-db-id" required>
            </div>
          </div>
          <div id="settings-error" class="notification error hidden"></div>
        </form>
      </section>
      <footer class="modal-footer">
        <button class="button secondary" id="cancel-settings-modal">Cancelar</button>
        <button class="button primary" type="submit" form="settings-form">Guardar Cambios</button>
      </footer>
    </div>
  </div>

  <script type="module" src="popup.js"></script>
</body>

</html>